## í”„ë¡œì íŠ¸ ì†Œê°œ

ë½€ë“ë½€ë“ì€Â `ì…€í”„ì„¸ì°¨ì¥ ì˜ˆì•½ ë° ê´€ë¦¬ ì„œë¹„ìŠ¤`ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
ì´ ì„œë¹„ìŠ¤ëŠ” ì˜ˆì•½ ê´€ë¦¬ë¥¼ ìë™í™”í•¨ìœ¼ë¡œì¨ ì‚¬ìš©ìì™€ ì„¸ì°¨ì¥ ê´€ë¦¬ì ëª¨ë‘ì—ê²Œ í¸ì˜ì„±ì„ ì œê³µí•©ë‹ˆë‹¤. ì‚¬ìš©ìë“¤ì€ ì›í•˜ëŠ” ì‹œê°„ì— ì„¸ì°¨ì¥ì„ ì˜ˆì•½í•  ìˆ˜ ìˆê³ , ê´€ë¦¬ìëŠ” ìì‹ ì˜ ì„¸ì°¨ì¥ì„ ì†ì‰½ê²Œ í™ë³´í•˜ê³  ì˜ˆì•½ì„ ê´€ë¦¬í•˜ì—¬ ë§¤ì¶œì„ ì¦ëŒ€ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì„œë¹„ìŠ¤ ì£¼ìš” ê¸°ëŠ¥

- **ì˜ˆì•½ ì‹œìŠ¤í…œ**
  - ì˜ˆì•½ ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ ê¸°ëŠ¥ êµ¬í˜„
  - ë“±ë¡ì„ í•˜ë©´ ìë™ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì˜ˆì•½ì‹œìŠ¤í…œì˜ ë„ì…ìœ¼ë¡œ í•´ì†Œ
  - ì„¸ì°¨ì¥ì„ ì˜ì—…ì‹œê°„ê³¼ ê°€ê²©ì„ ë“±ë¡í•˜ê³  ì„¸ì°¨ì¥ì—ì„œ ê°€ìš©ê°€ëŠ¥í•œ ë² ì´ë¥¼ ì§€ì •í•œ í•˜ë©´ ì„¸ì°¨ì¥ ì˜ˆì•½ê´€ë¦¬ì˜ ìë™í™”ê°€ ê°€ëŠ¥
- **ì„¸ì°¨ì¥ ê²€ìƒ‰ ì‹œìŠ¤í…œ**
  - ìœ„ì¹˜ê¸°ë°˜ ê²€ìƒ‰, í‚¤ì›Œë“œ ê¸°ë°˜ ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„
  - ì„¸ì°¨ì¥ì„ ì°¾ì„ë•Œ í•œëˆˆì— ë“¤ì–´ì˜¤ì§€ ì•Šë˜ í‚¤í¬ì¸íŠ¸ë“¤ -> í‚¤ì›Œë“œ ê²€ìƒ‰ì„ í†µí•´ ê° ì„¸ì°¨ì¥ë§ˆë‹¤
    ì–´ë–¤ í‚¤í¬ì¸íŠ¸ë“¤ì´ ìˆê³ , ì´ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŒ
  - ìœ„ì¹˜ê¸°ë°˜í•œ ì„¸ì°¨ì¥ ì°¾ê¸° ì‹œìŠ¤í…œ ë„ì…ìœ¼ë¡œ, ì„¸ì°¨ì¥ê³¼ ë‚˜ì™€ì˜ ê±°ë¦¬ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±
- **ë¦¬ë·° ì‹œìŠ¤í…œ**
  - ê° ì„¸ì°¨ ì˜ˆì•½ ê±´ìˆ˜ë§ˆë‹¤ ë¦¬ë·°ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŒ. í•´ë‹¹ ë¦¬ë·°ì— ëŒ€í•œ í‚¤ì›Œë“œë¡œ í•´ë‹¹ ì„¸ì°¨ì¥ì— ëŒ€í•œ ì‚¬ìš©ì ì…ì¥ì˜ í‰ê°€ê°€ ì–´ë– í•œì§€ í•œëˆˆì— íŒŒì•… ê°€ëŠ¥
  - ë³„ì  ì‹œìŠ¤í…œì„ í†µí•´ í•´ë‹¹ ì„¸ì°¨ì¥ì˜ í‰ê·  í‰ì ì´ ì–´ë–¤ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ
- **ì„¸ì°¨ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ**
  - ì„¸ì°¨ì¥ì„ ë“±ë¡ì„ ì†ì‰½ê²Œ í•˜ê³ , ë³´ìœ í•˜ê³  ìˆëŠ” ëª¨ë“  ì„¸ì°¨ì¥ë“¤ì˜ ë§¤ì¶œì„ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆê³ , ê°œë³„ ì„¸ì°¨ì¥ì˜ ì˜ˆì•½ í˜„í™©ê³¼ ë§¤ì¶œ ê´€ë¦¬ë¥¼ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¦
- **ê²°ì œí•˜ê¸°**
  - ì¹´ì¹´ì˜¤í˜ì´ apië¥¼ ì‚¬ìš©í•˜ì—¬ mock ê²°ì œ ì ˆì°¨ë¥¼ êµ¬í˜„
  - ê²°ì œ ê¸ˆì•¡ì— ê´€ë ¨í•œ ì‹ ë¢°ì„±ìˆëŠ” ë¡œì§ì„ êµ¬í˜„í•˜ì—¬ ê²°ì œ ì‹ ë¢°ì„± í™•ë³´

## í”„ë¡œì íŠ¸ ë¬¸ì„œ ë§í¬ ëª¨ìŒ

### ê°œë°œ ë¬¸ì„œ

| ë¬¸ì„œ ì¢…ë¥˜          | ë§í¬                                                                               |
| ------------------ | ---------------------------------------------------------------------------------- |
| API ë¬¸ì„œ           | [API ë¬¸ì„œ](https://www.notion.so/API-67efa4eea535426b89649a8c311b80a0?pvs=4)       |
| ERD                | [ERD](https://www.notion.so/ERD-984ec51ccd7e435f8331857a325d1516?pvs=4)            |
| ì—ëŸ¬ì½”ë“œ ì •ì˜ì„œ    | [ì—ëŸ¬ì½”ë“œ ì •ì˜ì„œ](https://www.notion.so/004bbaf9938443bd92e86c0f51bb70f0?pvs=4)    |
| ì½”ë”© ì»¨ë²¤ì…˜        | [ì½”ë”© ì»¨ë²¤ì…˜](https://www.notion.so/37636b2e131048acb4e238472496b246?pvs=4)        |
| Git ì‘ì—… ë‹¨ìœ„      | [Git ì‘ì—… ë‹¨ìœ„](https://www.notion.so/git-70b0a49482c8434abab83b06c0bc94c1?pvs=4)  |
| ì»¤ë°‹ ì»¨ë²¤ì…˜        | [ì»¤ë°‹ ì»¨ë²¤ì…˜](https://www.notion.so/f88b7fb79bf94fdca5099a70d971983b?pvs=4)        |
| í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤    | [í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤](https://www.notion.so/c55b2e5aff9b443a90d0799d3b84f8a5?pvs=4)    |
| í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë³´ê³ ì„œ | [í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë³´ê³ ì„œ](https://www.notion.so/5db4232de5c047a7b3eac6b4b214dfed?pvs=4) |

### ê¸°íš ë¬¸ì„œ

| ë¬¸ì„œ ì¢…ë¥˜     | ë§í¬                                                                                                                                                                                                                           |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| ê¸°íš ìë£Œ     | [ê¸°íš ìë£Œ](https://www.notion.so/as_is_to_be-8ab0b5dab76a4a608343200301ac5008?pvs=4)                                                                                                                                          |
| ê¸°íš ë°œí‘œìë£Œ | [ê¸°íš ë°œí‘œìë£Œ](https://www.notion.so/Weekly-01cdc0b6e98a418db0d7ee886e8b7594?pvs=4#64122c5a98cb4426b4302c94fdbe57a7)                                                                                                          |
| ì™€ì´ì–´ í”„ë ˆì„ | [ì™€ì´ì–´ í”„ë ˆì„](https://www.figma.com/file/raidVFqnBM3KgJY4KFCoB1/%EB%BD%80%EB%93%9D%EB%BD%80%EB%93%9D-%EC%99%80%EC%9D%B4%EC%96%B4%ED%94%84%EB%A0%88%EC%9E%84?type=design&node-id=478%3A3616&mode=design&t=tW0gdxACISuQbhdX-1) |

### ë°°í¬ ì£¼ì†Œ

| ì„œë¹„ìŠ¤          | ë§í¬                                                            |
| --------------- | --------------------------------------------------------------- |
| ë½€ë“ë½€ë“ ì‚¬ìš©ì | [ì‚¬ìš©ì í˜ì´ì§€](https://k923062c3c512a.user-app.krampoline.com) |
| ë½€ë“ë½€ë“ ê´€ë¦¬ì | [ê´€ë¦¬ì í˜ì´ì§€](https://kae2e326be433a.user-app.krampoline.com) |

## APIë¬¸ì„œ

| ê¶Œí•œ                     | ê¸°ëŠ¥              | ì„¤ëª…                          |
| ------------------------ | ----------------- | ----------------------------- |
| ê³µí†µ                     |                   |                               |
|                          | ğŸš— ì„¸ì°¨ì¥ ì¡°íšŒ    | ê³µê°œ ì„¸ì°¨ì¥ ì •ë³´ ì¡°íšŒ         |
|                          | ğŸ“ ë¦¬ë·° ì¡°íšŒ      | ê³µê°œ ë¦¬ë·° ì¡°íšŒ                |
|                          | ğŸ” ê²€ìƒ‰           | ì„¸ì°¨ì¥, ë¦¬ë·° ê²€ìƒ‰             |
|                          | ğŸ“– ì˜ˆì•½ ì •ë³´ ì¡°íšŒ | ê³µê°œ ì˜ˆì•½ ì •ë³´ ì¡°íšŒ           |
| ì¼ë°˜ íšŒì›, ì„¸ì°¨ì¥ ê´€ë¦¬ì |                   |                               |
|                          | ğŸ“… ì˜ˆì•½ ê´€ë¦¬      | ì˜ˆì•½ ìƒì„±, ìˆ˜ì •, ì·¨ì†Œ         |
|                          | ğŸ’¬ ë¦¬ë·° ê´€ë¦¬      | ë¦¬ë·° ì‘ì„±, ìˆ˜ì •, ì‚­ì œ         |
|                          | ğŸš— ì„¸ì°¨ì¥ ì¡°íšŒ    | ì„¸ì°¨ì¥ ìƒì„¸ ì •ë³´ ì¡°íšŒ         |
|                          | ğŸ“ˆ í†µê³„           | ì‚¬ìš©ì í†µê³„ ì¡°íšŒ              |
| ì„¸ì°¨ì¥ ê´€ë¦¬ì            |                   |                               |
|                          | ğŸš— ì„¸ì°¨ì¥ ê´€ë¦¬    | ì„¸ì°¨ì¥ ì •ë³´ ë“±ë¡, ìˆ˜ì •, ì‚­ì œ  |
|                          | ğŸ“… ì˜ˆì•½ ê´€ë¦¬      | ì˜ˆì•½ ìŠ¹ì¸, ê±°ì ˆ               |
|                          | ğŸ’¬ ë¦¬ë·° ì‘ë‹µ      | ë¦¬ë·°ì— ëŒ€í•œ ì‘ë‹µ ì‘ì„±         |
|                          | ğŸ“ˆ í†µê³„           | ì„¸ì°¨ì¥ ì˜ˆì•½ ë° ë§¤ì¶œ í†µê³„ ì¡°íšŒ |

## ì˜ˆì•½ ì‹ ë¢°ì„±

- ì‚¬ìš©ìê°€ ìš”ì²­í•œ ì˜ˆì•½ì´ ìš´ì˜ ì‹œê°„ì„ ì¤€ìˆ˜í•˜ê³  ì¤‘ë³µ ì˜ˆì•½ì´ ë°©ì§€ë˜ë„ë¡ ì˜ˆì•½ ê²€ì¦ì„ ì² ì €íˆ í•˜ì˜€ìŠµë‹ˆë‹¤.
  - **`ìš´ì˜ ì‹œê°„` ë‚´ ì˜ˆì•½ ê²€ì¦** : ìš´ì˜ì‹œê°„ ë‚´ì— ì˜ˆì•½ì´ ì´ë£¨ì–´ì§€ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
    - **24ì‹œê°„ ì˜ì—…** ë° **ìƒˆë²½ ì˜ì—…**(11:00~2:00)ì„ ì§€ì›í•©ë‹ˆë‹¤.

    ```java
    if (!((opStartTime.equals(LocalTime.MIDNIGHT) && opEndTime.equals(LocalTime.MIDNIGHT)) ||
          (opStartTime.isBefore(requestStartTimePart) || opStartTime.equals(requestStartTimePart)) &&
          (opEndTime.isAfter(requestEndTimePart) || opEndTime.equals(requestEndTimePart)))) {
        throw new BadRequestError(
                BadRequestError.ErrorCode.VALIDATION_FAILED,
                Collections.singletonMap("operatingHours", "Reservation time is out of operating hours")
        );
    }
    ```

  - **`ì¤‘ë³µ ì˜ˆì•½` ê²€ì¦** : ë‹¤ë¥¸ íšŒì›ì˜ ì˜ˆì•½ ì‹œê°„ê³¼ ê²¹ì¹˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
    - ìƒˆë¡œìš´ ì˜ˆì•½ì˜ ì¢…ë£Œ ì‹œê°„ì´ `ê¸°ì¡´ ì˜ˆì•½ì˜ ì‹œì‘ ì‹œê°„ ì´ì „`ì´ê³ , ìƒˆë¡œìš´ ì˜ˆì•½ì˜ ì‹œì‘ ì‹œê°„ì´ `ê¸°ì¡´ ì˜ˆì•½ì˜ ì¢…ë£Œ ì‹œê°„ ì´í›„`ì¸ ê²½ìš° ì •ìƒ ì˜ˆì•½ë©ë‹ˆë‹¤.

    ```java
    boolean isOverlapping = reservationList.stream()
         .anyMatch(existingReservation -> {
             LocalDateTime existingStartTime = existingReservation.getStartTime();
             LocalDateTime existingEndTime = existingReservation.getEndTime();

             return !(endTime.isEqual(existingStartTime) || startTime.isEqual(existingEndTime)) &&
                    !(endTime.isBefore(existingStartTime) || startTime.isAfter(existingEndTime));
         });
    
    if (isOverlapping) {
        throw new BadRequestError(
                BadRequestError.ErrorCode.DUPLICATE_RESOURCE,
                Collections.singletonMap("Reservation time", "Reservation time overlaps with an existing reservation.")
        );
    }
    ```

  - **`ë‚ ì§œê°€ ë„˜ì–´ê°€ëŠ” ì˜ˆì•½`**(23:00~01:00) ì§€ì› :  ì¢…ë£Œ ì‹œê°„ì— í•˜ë£¨ë¥¼ ë”í•¨ìœ¼ë¡œì¨ ì •ìƒì ìœ¼ë¡œ ì˜ˆì•½ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

      ```java
      LocalDateTime adjustedEndTime = endTime;
      if (endTime.toLocalTime().isBefore(startTime.toLocalTime())) {
          adjustedEndTime = endTime.plusDays(1);
      }
      long minutesBetween = Duration.between(startTime, adjustedEndTime).toMinutes();
      ```

  - **`ì˜ˆì•½ ì‹œê°„` ë°°ìˆ˜ ê²€ì¦** : ì˜ˆì•½ ì‹œê°„ì´ 30ë¶„ì˜ ë°°ìˆ˜ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.
  - `ìµœì†Œ ì˜ˆì•½` **ì‹œê°„ ê²€ì¦** **:** ì˜ˆì•½ ì‹œê°„ì´ ìµœì†Œ 30ë¶„ ì´ìƒì¸ì§€ ê²€ì‚¬í•©ë‹ˆë‹¤.
- ì˜ˆì•½ ê¶Œí•œë³„ ê°€ì´ë“œë¼ì¸
  - **ì˜ˆì•½ ì¡°íšŒ**
    - ì‚¬ìš©ìëŠ” ìì‹ ì˜ ì˜ˆì•½ ë‚´ì—­ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ì‚¬ì¥ë‹˜ì€ ì†Œìœ í•œ ë§¤ì¥ì˜ ëª¨ë“  ì˜ˆì•½ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - **ì˜ˆì•½ ìˆ˜ì •**
    - ì‚¬ìš©ìëŠ” ìì‹ ì˜ ì˜ˆì•½ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - **ì˜ˆì•½ ì·¨ì†Œ**
    - ì‚¬ìš©ìëŠ” ìì‹ ì˜ ì˜ˆì•½ë§Œ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - **ì˜ˆì•½ ì°¨ë‹¨**
    - ì‚¬ì¥ë‹˜ì€ ì†Œìœ í•œ ë§¤ì¥ì˜ ë² ì´(ì˜ˆì•½ê³µê°„)ì— ëŒ€í•´, ì˜ˆì•½ì„ ì¼ì‹œì ìœ¼ë¡œ ë°›ì§€ ëª»í•˜ë„ë¡ ì˜ˆì•½ ì°¨ë‹¨ ë° í•´ì œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
  - **ì˜ˆì•½ í†µê³„**
    - ì‚¬ì¥ë‹˜ì€ ì†Œìœ í•œ ë§¤ì¥ì— ëŒ€í•´ **ì´ ë§¤ì¶œ ë° íŒë§¤ ìˆ˜ìµ**, **ì˜ˆì•½ í˜„í™©**ì„ ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì†ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## **ê²°ì œ ì‹ ë¢°ì„±**

### **ì¹´ì¹´ì˜¤í˜ì´ ê¸°ë°˜ ê²°ì œ ì‹œìŠ¤í…œ**

- `ì¹´ì¹´ì˜¤í˜ì´ ê²°ì œ API`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ì œ ì¤€ë¹„ ë° ê²°ì œ ìŠ¹ì¸ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

### **ê¸ˆì•¡ ê²€ì¦ ë©”ì»¤ë‹ˆì¦˜**

- **í”„ë¡ íŠ¸ì—”ë“œ ê¸ˆì•¡ ê²€ì¦**: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìš”ì²­í•œ ê²°ì œ ê¸ˆì•¡(**`total_amount`**)ê³¼ ì„œë²„ ì¸¡ì—ì„œ ê³„ì‚°í•œ ê¸ˆì•¡ì„ ë¹„êµí•˜ì—¬ ê²°ì œ ì˜¤ë¥˜ë¥¼ ë¯¸ì—°ì— ë°©ì§€í•©ë‹ˆë‹¤.
- í”„ë¡ íŠ¸ì—”ë“œì™€ ì„œë²„ ì¸¡ì˜ ê³„ì‚° ê¸ˆì•¡ì´ ë‹¤ë¥¼ ê²½ìš°, **`BadRequestError`**(`400`) ì˜ˆì™¸ (**`1001 VALIDATION_FAILED`** ì—ëŸ¬ ì½”ë“œ)ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.
```java
// ê¸ˆì•¡ ê³„ì‚°
int perPrice = carwash.getPrice();
int minutesDifference = (int) ChronoUnit.MINUTES.between(startTime, endTime);
int blocksOf30Minutes = minutesDifference / 30;
int price = perPrice * blocksOf30Minutes;
int totalAmount = price;

// ê²€ì¦
if (totalAmount != requestDto.getTotal_amount())
    throw new BadRequestError(
            BadRequestError.ErrorCode.WRONG_REQUEST_TRANSMISSION,
            Collections.singletonMap("pay", "Invalid pay amount")
    );
```
## ê²€ì¦

- **AOPë¥¼ ì‚¬ìš©í•œ ìœ íš¨ì„± ê²€ì¦**
  - **`GlobalValidationHandler`ì—ì„œ** `POST`ì™€ `PUT` ìš”ì²­ì— ëŒ€í•œ ê³µí†µì ì¸ ìœ íš¨ì„± ê²€ì¦ ë¡œì§ì„ ì •ì˜í–ˆìŠµë‹ˆë‹¤.
  - ìœ íš¨ì„± ê²€ì¦ ì˜¤ë¥˜ê°€ ìˆì„ ê²½ìš° **`BadRequestError`**(`400`) ì˜ˆì™¸ë¥¼ ë°œìƒì‹œì¼°ìŠµë‹ˆë‹¤.
- **DTO ë‚´ë¶€ì˜ `@Valid` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ ê²€ì¦ : `@NotBlank`**, **`@Size`**, **`@NotNull`** ë“±ì˜ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ê° í•„ë“œì˜ ìœ íš¨ì„± ê·œì¹™ì„ ìƒì„±í•˜ê³  ê²€ì¦í–ˆìŠµë‹ˆë‹¤.

```java
@Getter
@Setter
public static class FileUpdateDTO {
    @NotBlank(message = "File URL is required")
    private String url;

    @PastOrPresent(message = "Uploaded time must be in the past or present")
    private LocalDateTime uploadedAt;
}
```

## ì˜ˆì™¸ ì²˜ë¦¬

### **ëª…í™•í•œ ì˜ˆì™¸ ì²˜ë¦¬ ë° ìƒíƒœì½”ë“œ í• ë‹¹**

- `HTTP ìƒíƒœ ì½”ë“œ`ì— ë”°ë¼ ì˜ˆì™¸ í´ë˜ìŠ¤ë¥¼ ì •ì˜í•˜ì—¬ ì˜ˆì™¸ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![Untitled](readme_images/Untitled.png)

- ìƒíƒœ ì½”ë“œ ë‚´ì—ì„œ `ì‚¬ìš©ì ì •ì˜ ì—ëŸ¬ ì½”ë“œ`ë¥¼ ì •ì˜í•˜ì—¬ ëª…í™•í•˜ê²Œ ì˜¤ë¥˜ì˜ ì„¸ë¶€ ì‚¬í•­ì„ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
public enum ErrorCode implements ApiException.ErrorCode {
    VALIDATION_FAILED(1001, "Request Validation Failed"),
    WRONG_REQUEST_TRANSMISSION(1002, "Wrong Request Transmission"),
    MISSING_PART(1003, "Missing essential part"),
    DUPLICATE_RESOURCE(1004, "Duplicate Resource");
    ...
}
```

- ì˜ˆì™¸ ë°œìƒì‹œ `status`(ìƒíƒœ ì½”ë“œ), `code`(ì‚¬ìš©ì ì •ì˜ ì—ëŸ¬ì½”ë“œ), `message`(ì—ëŸ¬ ë©”ì„¸ì§€) í˜•ì‹ì„ ì§€ì¼œ ì¼ê´€ëœ ì‘ë‹µì´ ì „ì†¡ë˜ë„ë¡ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
<img width="444" alt="image" src="https://github.com/Step3-kakao-tech-campus/Team10_BE/assets/78211281/abe61e0f-9a86-4529-852e-e5edbe2cf1ed">

- **`GlobalExceptionHandler`** ì—ì„œ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ì˜ˆì™¸ë¥¼ ì¡ê³  ì ì ˆí•œ HTTP ì‘ë‹µì„ ë°˜í™˜í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.
- `DefaultErrorAttributes`Â í´ë˜ìŠ¤ë¥¼ í™•ì¥í•œÂ **`CustomErrorAttributes`Â ë¥¼**Â êµ¬í˜„í•˜ì—¬ í•¸ë“¤ëŸ¬ê°€ ì¡ì§€ ëª»í•œ ëª¨ë“  ì˜ˆì™¸ì— ëŒ€í•´ì„œë„ ì¼ê´€ëœ ì‘ë‹µ í˜•ì‹ì„ ë³´ì¥í–ˆìŠµë‹ˆë‹¤.

```java
@Override
public Map<String, Object> getErrorAttributes(
        WebRequest webRequest, ErrorAttributeOptions options) {
    Map<String, Object> defaultErrorAttributes = super.getErrorAttributes(webRequest, options);

    Map<String, Object> customErrorAttributes = new LinkedHashMap<>();
    boolean errorOccurred = !defaultErrorAttributes.get("status").equals(200);
    int status = (int) defaultErrorAttributes.get("status");

    if (errorOccurred) {
        Map<String, Object> errorDetails = new LinkedHashMap<>();

        Object defaultMessage = defaultErrorAttributes.get("message");
        String customMessage = (status == 404) ? "Not Found" : String.valueOf(defaultMessage);

        errorDetails.put("status", String.valueOf(status));
        errorDetails.put("code", NotFoundError.ErrorCode.RESOURCE_NOT_FOUND.getCode());
       ...
    return customErrorAttributes;
}
```
- ìƒˆë¡œìš´ ì˜ˆì™¸ ìœ í˜•ì„ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í™•ì¥ ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

## ë³´ì•ˆ

### íŒŒì¼ ì‹ ë¢°ì„±

- `íŒŒì¼ í™•ì¥ì` ê²€ì¦ : ì§€ì • íŒŒì¼ í˜•ì‹ë§Œ ì—…ë¡œë“œë¥¼ í—ˆìš©í•˜ì—¬ ë³´ì•ˆ ë° ë°ì´í„° ë¬´ê²°ì„±ì„ ê°•í™”í•©ë‹ˆë‹¤.

```java
static final List<String> ALLOWED_EXTENSIONS = Arrays.asList(".jpg", ".jpeg", ".png");
```

- `ê³ ìœ  íŒŒì¼ëª…`: UUIDë¥¼ í†µí•´ ê³ ìœ í•œ íŒŒì¼ ì´ë¦„ì„ ìƒì„±í•˜ì—¬ ì›ë³¸ íŒŒì¼ëª…ì´ ë…¸ì¶œë˜ì§€ ì•Šê³  íŒŒì¼ëª… ì¶©ëŒì„ ë°©ì§€í•©ë‹ˆë‹¤.

```java
static final List<String uniqueFilename = UUID.randomUUID().toString() + extension;
        String keyName = "uploads/" + uniqueFilename;> ALLOWED_EXTENSIONS = Arrays.asList(".jpg", ".jpeg", ".png");
```

### CORS ì„¤ì • í™˜ê²½ë³„ ë¶„ë¦¬

- ì™€ì¼ë“œ ì¹´ë“œ(`*`)ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  `íŠ¹ì • ì¶œì²˜`ë§Œ í—ˆìš©í•˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
- ê°œë°œ í™˜ê²½ê³¼ ìš´ì˜ í™˜ê²½ì— ë”°ë¼ CORS ì„¤ì •ì„ êµ¬ë¶„í–ˆìŠµë‹ˆë‹¤.
  - `ê°œë°œ í™˜ê²½`: ë¡œì»¬ urlë¡œ ì§€ì •ëœ íŠ¹ì • ì¶œì²˜ë§Œì„ í—ˆìš©í–ˆìŠµë‹ˆë‹¤.
  - `ìš´ì˜ í™˜ê²½`: íŠ¹ì • íŒ¨í„´ì„ ì„¤ì •í•˜ì—¬ í—ˆìš©ë˜ëŠ” ì¶œì²˜ë¥¼ ì—„ê²©íˆ ì œí•œí–ˆìŠµë‹ˆë‹¤.

```java
@Bean
    @Profile("!prod")
    public CorsConfigurationSource devCorsConfigurationSource() {
        // ê°œë°œ í™˜ê²½ìš© CORS ì„¤ì •
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.addAllowedHeader("*");
        configuration.addAllowedMethod("*");
        configuration.addAllowedOrigin(frontlocalurl);
        configuration.setAllowCredentials(true);
        configuration.addExposedHeader("Authorization");

        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);

        return source;
    }

    @Bean
    @Profile("prod")
    public CorsConfigurationSource prodCorsConfigurationSource() {
        // ìš´ì˜ í™˜ê²½ìš© CORS ì„¤ì •
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.addAllowedHeader("*");
        configuration.addAllowedMethod("*");
        // USER, OWNER ë°°í¬ ì£¼ì†Œ (React)
        configuration.addAllowedOriginPattern(prodfrontuserurl);
        configuration.addAllowedOriginPattern(prodfrontownerurl);
        configuration.setAllowCredentials(true);
        configuration.addExposedHeader("Authorization");

        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);

        return source;
    }
```

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ë° **Kubernetes Secret ì‚¬ìš©**

![Untitled](readme_images/Untitled%201.png)

- ë³´ì•ˆì„ ê°•í™”í•˜ê¸°ìœ„í•´ **`@Value` ì„ í†µí•´** êµ¬ì„±ê°’ì„ ì†ŒìŠ¤ ì½”ë“œ ë‚´ì— í•˜ë“œì½”ë”©í•˜ì§€ ì•Šê³  ì™¸ë¶€ êµ¬ì„± íŒŒì¼ê³¼ Kubernetesì˜ Secretì„ í™œìš©í•˜ì—¬ ê´€ë¦¬í•©ë‹ˆë‹¤.
- ë³€ê²½ ê°€ëŠ¥ì„±ì´ ìˆëŠ” keyë“¤ì„ í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬í•˜ì—¬ ì¬ì‚¬ìš©ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

## **ê¶Œí•œ ì¤‘ì‹¬ì˜ ì‚¬ìš©ì ë° ê´€ë¦¬ì ê²½í—˜ ìµœì í™”**

- `ì—­í•  ê¸°ë°˜` ê¶Œí•œê´€ë¦¬ : Roleì— ë”°ë¥¸ ê¶Œí•œ ë¶„ë¦¬(Spring Security)

```java
http.authorizeRequests(authorize -> authorize
                .antMatchers("/api/open/**").permitAll()
                .antMatchers("/api/user/**").access("hasAnyRole('USER', 'OWNER')")
                .antMatchers("/api/owner/**").access("hasRole('OWNER')")
                .anyRequest().authenticated());

```

- `ì‚¬ìš©ì ì¸ì¦ ë° JWT í† í° ì²˜ë¦¬` **:** JWT í† í°ì„ ê²€ì¦í•˜ê³  ê¶Œí•œ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    
    ```java
    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws IOException, ServletException {
        String jwt = request.getHeader(JWTProvider.HEADER);
    
        try {
            if (jwt != null && !isNonProtectedUrl(request)) {
                DecodedJWT decodedJWT = JWTProvider.verify(jwt);
                Long id = decodedJWT.getClaim("id").asLong();
                String role = decodedJWT.getClaim("role").asString();
                ..
        chain.doFilter(request, response);
    }
    
    private boolean isNonProtectedUrl(HttpServletRequest request) {
        AntPathRequestMatcher openMatcher = new AntPathRequestMatcher("/api/open/**");
        return openMatcher.matches(request);
    }
    ```
    

- **ì»¨íŠ¸ë¡¤ëŸ¬ ë¶„ë¦¬ :** **ê³µí†µ(ìœ ì €, ì‚¬ì¥ë‹˜) / ìœ ì € / ì‚¬ì¥ë‹˜ / ë‘˜ëŸ¬ë³´ê¸°** ê¶Œí•œìœ¼ë¡œ ë¶„ë¥˜í–ˆìŠµë‹ˆë‹¤.


![Untitled](readme_images/Untitled%202.png)

## ë¦¬íŒ©í† ë§

- **ì¬ì‚¬ìš©ì„±** : ë°˜ë³µë˜ì–´ ì‚¬ìš©ë˜ëŠ” ë©”ì„œë“œë“¤ì„ ì¶”ì¶œí•´ utilsë¡œ ë¶„ë¦¬í•˜ì—¬ ì½”ë“œ ì¬ì‚¬ìš©ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

![Untitled](readme_images/Untitled%203.png)

- **ì½”ë”© ì»¨ë²¤ì…˜** : ì½”ë”© ì»¨ë²¤ì…˜ì— ë”°ë¼ í´ë˜ìŠ¤, ë©”ì„œë“œëª…, ë³€ìˆ˜ëª…ë“±ì„ ì‘ì„±í•˜ê³  ë„ì–´ì“°ê¸° ë° ì¤‘ê´„í˜¸
  ìŠ¤íƒ€ì¼ë“±ì„ ì§€ì¼œ ì½”ë“œ í†µì¼ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ğŸ“¦src
 â”£ ğŸ“‚main
 â”ƒ â”£ ğŸ“‚java
 â”ƒ â”ƒ â”£ ğŸ“‚bdbe
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚bdbd
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚_core
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚config
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œAWSConfig.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œRestTemplateConfig.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚exception
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œApiException.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œBadGatewayError.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œBadRequestError.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCustomErrorAttributes.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œForbiddenError.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œInternalServerError.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œNotFoundError.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œUnAuthorizedError.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚handler
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œGlobalExceptionHandler.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œGlobalValidationHandler.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚security
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCustomUserDetails.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCustomUserDetailsService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œJWTProvider.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œJwtAuthenticationFilter.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œSecurityConfig.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚utils
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œApiUtils.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œDateUtils.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œFileUploadUtil.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œFilterResponseUtils.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œHaversine.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œKeywordTypeConverter.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œMemberUtils.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚controller
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚common
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCommonMemberController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚open
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œOpenCarwashController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œOpenMemberController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œOpenReservationController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œOpenReviewController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚owner
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œOwnerBayRestController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œOwnerCarwashController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚user
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œUserPayController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œUserReservationController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œUserReviewController.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚dto
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚bay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œBayRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œBayResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚carwash
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œCarwashRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCarwashResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚file
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œFileRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œFileResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚member
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚owner
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œOwnerResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚user
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œUserRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œUserResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚pay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œPayRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œPayResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚reservation
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œReservationRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReservationResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚review
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œReviewRequest.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReviewResponse.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚model
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚bay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œBay.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚carwash
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCarwash.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚file
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œFile.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚keyword
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚carwashKeyword
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCarwashKeyword.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚reviewKeyword
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReviewKeyword.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œKeyword.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚location
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œLocation.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚member
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œMember.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚optime
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œOptime.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚reservation
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReservation.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚review
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReview.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCode.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚pay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œ.DS_Store
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚repository
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚bay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œBayJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚carwash
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCarwashJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚file
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œFileJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚keyword
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚carwashKeyword
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCarwashKeywordJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚reviewKeyword
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReviewKeywordJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œKeywordJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚location
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œLocationJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚member
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œMemberJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚optime
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œOptimeJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚reservation
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReservationJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚review
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReviewJPARepository.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚service
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚bay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œBayService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚carwash
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œCarwashService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚file
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œFileService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚member
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œOwnerService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œUserService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚pay
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œPayService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“‚reservation
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReservationService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“‚review
 â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œReviewService.java
 â”ƒ â”ƒ â”ƒ â”ƒ â”£ ğŸ“œ.DS_Store
 â”ƒ â”ƒ â”ƒ â”ƒ â”— ğŸ“œBdbdApplication.java
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œ.DS_Store
 â”ƒ â”ƒ â”— ğŸ“œ.DS_Store
 â”ƒ â”£ ğŸ“‚resources
 â”ƒ â”ƒ â”£ ğŸ“œapplication-local.yml
 â”ƒ â”ƒ â”£ ğŸ“œapplication-prod.yml
 â”ƒ â”ƒ â”— ğŸ“œapplication.yml
 â”ƒ â”— ğŸ“œ.DS_Store
```


## ì¤‘ê°„ í”¼ë“œë°± ë°˜ì˜ë„

### ì´ë¯¸ì§€ íŒŒì¼ ê´€ë¦¬

- S3ì— ë‹¤ìš´ë¡œë“œëœ ëª¨ë“  ì´ë¯¸ì§€ íŒŒì¼ì€ ì§€ì •ëœ ê²½ë¡œì— ì €ì¥
- íŒŒì¼ ì „ì†¡ì˜ ì •í™•ì„±ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ë¡œì§ì„ êµ¬í˜„í•˜ì—¬, íŒŒì¼ ì „ë‹¬ ê³¼ì •ì—ì„œì˜ ì˜¤ë¥˜ ìµœì†Œí™”

### ì˜ˆì•½ ì‹œìŠ¤í…œ ìµœì í™”

- ì˜ˆì•½ ë°ì´í„°ì— ëŒ€í•œ ë‚ ì§œ ë° ìƒíƒœ ê´€ë¦¬ë¥¼ ì² ì €íˆ í•˜ì—¬ ì‹œìŠ¤í…œì˜ ë¬´ê²°ì„±ì„ ë³´ì¥
- ì˜ˆì•½ ì‹œìŠ¤í…œì˜ ë¡œì§ì„ êµ¬ì¡°í™”í•˜ì—¬, ê´€ë¦¬ ë° ìœ ì§€ë³´ìˆ˜ì˜ ìš©ì´ì„±ì„ ê°•í™”

### ì§€ë„ ê²€ìƒ‰ ê°œì„ 

- ì‚¬ìš©ì ìœ„ì¹˜ê¸°ë°˜ ì„¸ì°¨ì¥ ì¡°íšŒ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ ê°ê°ì˜ ìœ„ë„, ê²½ë„ë¥¼ location entityë¡œ ì €ì¥í•˜ê³ , Haversineê³µì‹ì„ ì‚¬ìš©í•´ ì‚¬ìš©ìì™€ ì„¸ì°¨ì¥ë“¤ê°„ì˜ ê±°ë¦¬ ê³„ì‚°
```java
public List<CarwashRequest.CarwashDistanceDTO> findNearbyCarwashesByUserLocation(CarwashRequest.UserLocationDTO userLocation) {
    List<Carwash> carwashes = carwashJPARepository.findCarwashesWithin10Kilometers(userLocation.getLatitude(), userLocation.getLongitude());

    return carwashes.stream()
            .map(carwash -> {
                double distance = Haversine.distance(userLocation.getLatitude(), userLocation.getLongitude(),
                        carwash.getLocation().getLatitude(), carwash.getLocation().getLongitude());
            ...
.sorted(Comparator.comparingDouble(CarwashRequest.CarwashDistanceDTO::getDistance))
            .collect(Collectors.toList());
}
```
- ë°˜ê²½ 10km ë‚´ì˜ ì„¸ì°¨ì¥ì„ ê²€ìƒ‰í•˜ëŠ” JPQL Query ì‘ì„±
```java
@Query(value = "SELECT cw.* FROM carwash cw JOIN location l ON cw.l_id = l.id WHERE ST_Distance_Sphere(point(l.longitude, l.latitude), point(:longitude, :latitude)) <= 10000", nativeQuery = true)
List<Carwash> findCarwashesWithin10Kilometers(@Param("latitude") double latitude, @Param("longitude") double longitude);
```
  
### ë³´ì•ˆ ë° ê¶Œí•œ ê´€ë¦¬

- Spring Securityë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ê¶Œí•œ ê´€ë¦¬ë¥¼ ê°•í™”
- ë³´ì•ˆ í”„ë¡œí† ì½œì„ ì—…ë°ì´íŠ¸í•˜ê³ , ì ‘ê·¼ ì œì–´ ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•´ ì‹œìŠ¤í…œì˜ ì•ˆì „ì„ ë³´ì¥

### ê²€ìƒ‰ ê¸°ëŠ¥ ê°œì„ 

- ì‚¬ìš©ìê°€ ì„ íƒí•œ ì„¸ì°¨ì¥ í‚¤ì›Œë“œë“¤ì˜ êµì§‘í•©ì— í•´ë‹¹í•˜ëŠ” ì„¸ì°¨ì¥ì„ ì¡°íšŒ
```java
List<CarwashRequest.CarwashDistanceDTO> result = carwashesWithin10Km.stream()
                .filter(carwash -> {
                    List<Long> keywordIdsForCarwash = findKeywordIdsByCarwashId(carwash.getId());
                    return keywordIds.stream()
                            .allMatch(keywordIdsForCarwash::contains);
                }) 
```  

### ì—ëŸ¬ ì½”ë“œ ê´€ë¦¬

- ì‹œìŠ¤í…œì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì—ëŸ¬ë¥¼ ì‹ë³„í•˜ê³ , í•„ìš”í•œ ì—ëŸ¬ ëª¨ë“œë¥¼ ì •ì˜í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ í”¼ë“œë°±ì„ ì œê³µ
- ì—ëŸ¬ í•¸ë“¤ë§ ì ˆì°¨ë¥¼ ê°„ì†Œí™”í•˜ì—¬, ê°œë°œìê°€ ì—ëŸ¬ë¥¼ ë” ë¹ ë¥´ê²Œ ì‹ë³„í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆë„ë¡ ì§€ì›

ìœ„ ê° í•­ëª©ì€ ì‚¬ìš©ì ê²½í—˜ì„ ì¤‘ì‹¬ìœ¼ë¡œ, ì•ˆì •ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ ì œê³µì„ ëª©í‘œë¡œ í•¨

## ERD ì„¤ê³„ì„œ

![Untitled](readme_images/Untitled%204.png)


## ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨\_ì‚¬ìš©ì ê´€ì 

![Untitled](readme_images/Untitled%205.png)
